version: 2

models:
  - name: marts_spatial_price
    description: Summary of available amenities and house price in a city district
    config:
      tags: [spatial, marts]
      shapefile_paths:
        - "../dataset/shp/kota/ADMINISTRASIDESA_AR_25K.shp"
        - "../dataset/shp/kab/ADMINISTRASIDESA_AR_25K.shp"
    constraints:
      - type: primary_key
        columns: [place]
    columns:
      - name: place
        description: District in the city
        tests:
          - not_null
          - unique
      - name: education
        description: Number of education institution in the district (school, college, universities, etc.)
        tests:
          - dbt_utils.accepted_range:
              min_value: 0
      - name: entertainment
        description: Number of entertainment place in the district (cinema, theater, etc.)
        tests:
          - dbt_utils.accepted_range:
              min_value: 0
      - name: facilities
        description: Number of facilities in the district (parking area, etc.)
        tests:
          - dbt_utils.accepted_range:
              min_value: 0
      - name: financial
        description: Number of financial services in the district (bank, ATM, etc.)
        tests:
          - dbt_utils.accepted_range:
              min_value: 0
      - name: healthcare
        description: Number of healthcare services in the district (hospital, clinic, etc.)
        tests:
          - dbt_utils.accepted_range:
              min_value: 0
      - name: public_service
        description: Number of public services in the district (government office, etc.)
        tests:
          - dbt_utils.accepted_range:
              min_value: 0
      - name: sustenance
        description: Number of sustenance services in the district (restaurant, cafe, etc.)
        tests:
          - dbt_utils.accepted_range:
              min_value: 0
      - name: transportation
        description: Number of transportation services in the district (bus stop, train station, etc.)
        tests:
          - dbt_utils.accepted_range:
              min_value: 0
      - name: price
        description: House price in million IDR
        tests:
          - dbt_utils.accepted_range:
              min_value: 0

  - name: marts_spatial_correlation_matrix
    description: Correlation matrix of available amenities and house price in a city district. Correlation is calculated using Pearson correlation coefficient.
    config:
      tags: [spatial, marts, correlation]
    constraints:
      - type: primary_key
        columns: [place]
    columns:
      - name: education
        description: Pearson correlation coefficient between number of education institution and house price
        tests:
          - dbt_utils.accepted_range:
              min_value: -1
              max_value: 1
      - name: entertainment
        description: Pearson correlation coefficient between number of entertainment place and house price
        tests:
          - dbt_utils.accepted_range:
              min_value: -1
              max_value: 1
      - name: facilities
        description: Pearson correlation coefficient between number of facilities and house price
        tests:
          - dbt_utils.accepted_range:
              min_value: -1
              max_value: 1
      - name: financial
        description: Pearson correlation coefficient between number of financial services and house price
        tests:
          - dbt_utils.accepted_range:
              min_value: -1
              max_value: 1
      - name: healthcare
        description: Pearson correlation coefficient between number of healthcare services and house price
        tests:
          - dbt_utils.accepted_range:
              min_value: -1
              max_value: 1
      - name: public_service
        description: Pearson correlation coefficient between number of public services and house price
        tests:
          - dbt_utils.accepted_range:
              min_value: -1
              max_value: 1
      - name: sustenance
        description: Pearson correlation coefficient between number of sustenance services and house price
        tests:
          - dbt_utils.accepted_range:
              min_value: -1
              max_value: 1
      - name: transportation
        description: Pearson correlation coefficient between number of transportation services and house price
        tests:
          - dbt_utils.accepted_range:
              min_value: -1
              max_value: 1
      - name: price
        description: Pearson correlation coefficient between house price and itself
        tests:
          - dbt_utils.accepted_range:
              min_value: -1
              max_value: 1

